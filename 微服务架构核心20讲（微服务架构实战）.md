# 微服务架构核心20讲（微服务架构实战）

## 联系方式

客服微信号：itziyuan_xiaozhi

<img src="https://ziyuanyun.oss-cn-guangzhou.aliyuncs.com/common/20240614073449/666b82192834a.jpg" width="200" height="200" alt="二维码">

## 课程简介

下载链接：https://it.dyqufx.com/posts?id=2318

<img src="https://ziyuanyun.oss-cn-guangzhou.aliyuncs.com/yun/20240515183822/6644909e2539f.jpg" width="500" alt="">

  互联网时代，企业在瞬息万变的市场赢得和保持竞争优势的核心在于持续创新。业界前沿互联网公司的实践表明，微服务架构 (Microservices Architecture) 是企业应对业务复杂性，支持大规模持续创新行之有效的架构手段。

 微服务架构作为一种渐进式的演进架构，自提出以来便被互联网企业和传统企业所重视和采用。微服务架构所涉及的知识广泛，其学习曲线相对陡峭，其中架构落地、网关、监控等技术问题是常见的挑战。技术人员光靠自学摸索，通常需要耗费不少时间精力。由于微服务架构可操作学习的案例相对较少，尤其是大型业务微服务架构应用案例，所以大家对微服务架构理念虽然有一定理解，但是对微服务架构如何落地缺乏可靠的最佳实践经验。

 技术基础和平台工具易学，但架构思维和落地经验难建。一个合格的架构师除了最核心的技术理论基础之外，必须具备良好的架构视野和思维模式，以及通过技术与业务结合的落地实践所总结的行之有效的经验和方法论。

 本视频课程特邀请有十余年互联网分布式系统研发和架构经验的资深架构师杨波老师就“微服务架构核心要点”做深入浅出的总结与阐述，希望能帮助技术人员在微服务架构落地实践中提高效率，少走弯路。

 ├─-微服务架构核心20讲

 | ├──01丨什么是微服务架构？_.mp4 97.91M

 | ├──02丨架构师如何权衡微服务的利弊？_.mp4 82.61M

 | ├──03丨康威法则和微服务给架构师怎样的启示？_.mp4 65.28M

 | ├──04丨企业应该在什么时候开始考虑引入微服务？_.mp4 108.02M

 | ├──05丨什么样的组织架构更适合微服务？_.mp4 100.55M

 | ├──06丨如何理解阿里巴巴提出的微服务中台战略？_.mp4 103.84M

 | ├──07丨如何给出一个清晰简洁的服务分层方式？_.mp4 73.34M

 | ├──08丨微服务总体技术架构体系是怎样设计的？_.mp4 96.72M

 | ├──09丨微服务最经典的三种服务发现机制_.mp4 87.13M

 | ├──10丨微服务 API 服务网关（一）原理_.mp4 71.55M

 | ├──11丨微服务 API 服务网关（二）开源网关 Zuul_.mp4 87.12M

 | ├──12丨跟 Netflix 学习微服务路由发现体系_.mp4 57.14M

 | ├──13丨集中式配置中心的作用和原理是什么？_.mp4 121.92M

 | ├──14丨微服务通讯方式 RPC vs REST_.mp4 117.61M

 | ├──15丨微服务框架需要考虑哪些治理环节？_.mp4 92.80M

 | ├──16丨微服务监控系统分层和监控架构_.mp4 98.08M

 | ├──17丨微服务的调用链监控该如何选型？_.mp4 110.29M

 | ├──18丨微服务的容错限流是如何工作的？_.mp4 116.09M

 | ├──19丨Docker 容器部署技术 &amp; 持续交付流水线_.mp4 115.57M

 | └──20丨容器集群调度和基于容器的发布体系_.mp4 102.78M

 

 如何快速搭建一个微服务架构 什么是微服务？微服务(Microservices Architecture)是一种架构风格，一个大型复杂软件应用由一个或多个微服务组成。系统中的各个微服务可被独立部署，各个微服务之间是松耦合的。每个微服务仅关注于完成一件任务并很好地完成该任务。在所有情况下，每个任务代表着一个小的业务能力。微服务的概念源于2014年3月Martin Fowler所写的文章“Microservices”martinfowler.com/articles/mi…单体架构(Monolithic Architecture )企业级的应用一般都会面临各种各样的业务需求，而常见的方式是把大量功能堆积到同一个单体架构中去。比如：常见的ERP、CRM等系统都以单体架构的方式运行，同时由于提供了大量的业务功能，随着功能的升级，整个研发、发布、定位问题，扩展，升级这样一个“怪物”系统会变得越来越困难。这种架构模式就是把应用整体打包部署，具体的样式依赖本身应用采用的语言，如果采用java语言，自然你会打包成war包，部署在Tomcat或者Jetty这样的应用服务器上，如果你使用spring boot还可以打包成jar包部署。其他还有Rails和Node.js应用以目录层次的形式打包上图：单体架构大部分企业通过SOA来解决上述问题，SOA的思路是把应用中相近的功能聚合到一起，以服务的形式提供出去。因此基于SOA架构的应用可以理解为一批服务的组合。SOA带来的问题是，引入了大量的服务、消息格式定义和规范。多数情况下，SOA的服务直接相互独立，但是部署在同一个运行环境中（类似于一个Tomcat实例下，运行了很多web应用）。和单体架构类似，随着业务功能的增多SOA的服务会变得越来越复杂，本质上看没有因为使用SOA而变的更好。图1，是一个包含多种服务的在线零售网站，所有的服务部署在一个运行环境中，是一个典型的单体架构。单体架构的应用一般有以下特点：微服务架构（Microservices Architecture）微服务架构的核心思想是，一个应用是由多个小的、相互独立的、微服务组成，这些服务运行在自己的进程中，开发和发布都没有依赖。不同服务通过一些轻量级交互机制来通信，例如 RPC、HTTP 等，服务可独立扩展伸缩，每个服务定义了明确的边界，不同的服务甚至可以采用不同的编程语言来实现，由独立的团队来维护。简单的来说，一个系统的不同模块转变成不同的服务！而且服务可以使用不同的技术加以实现！上图：微服务架构那我们在微服务中应该怎样设计呢。以下是微服务的设计指南：在单体架构中，不同功能之间通信通过方法调用，或者跨语言通信。SOA降低了这种语言直接的耦合度，采用基于SOAP协议的web服务。这种web服务的功能和消息体定义都十分复杂，微服务需要更轻量的机制。同步消息 REST同步消息就是客户端需要保持等待，直到服务器返回应答。REST是微服务中默认的同步消息方式，它提供了基于HTTP协议和资源API风格的简单消息格式，多数微服务都采用这种方式（每个功能代表了一个资源和对应的操作）异步消息 – AMQP, STOMP, MQTT异步消息就是客户端不需要一直等待服务应答，有应到后会得到通知。某些微服务需要用到异步消息，一般采用AMQP, STOMP, MQTT 这三种通讯协议消息格式 – JSON, XML, Thrift, ProtoBuf, Avro消息格式是微服务中另外一个很重要的因素。SOA的web服务一般采用文本消息，基于复杂的消息格式（SOAP）和消息定义（xsd）。微服务采用简单的文本协议JSON和XML，基于HTTP的资源API风格。如果需要二进制，通过用到Thrift, ProtoBuf, Avro。服务约定 – 定义接口 – Swagger, RAML, Thrift IDL如果把功能实现为服务，并发布，需要定义一套约定。单体架构中，SOA采用WSDL，WSDL过于复杂并且和SOAP紧耦合，不适合微服务。REST设计的微服务，通常采用Swagger和RAML定义约定。对于不是基于REST设计的微服务，比如Thrift，通常采用IDL（Interface Definition Languages），比如Thrift IDL。微服务集成 (服务间通信)大部分微服务基于RPC、HTTP、JSON这样的标准协议，集成不同标准和格式变的不再重要。另外一个选择是采用轻量级的消息总线或者网关，有路由功能，没有复杂的业务逻辑。下面就介绍几种常见的架构方式。点对点方式中，服务之间直接用。每个微服务都开放REST API，并且调用其它微服务的接口。上图：通过点对点方式通信很明显，在比较简单的微服务应用场景下，这种方式还可行，随着应用复杂度的提升，会变得越来越不可维护。这点有些类似SOA的ESB，尽量不采用点对点的集成方式。API-网关方式API网关方式的核心要点是，所有的客户端和消费端都通过统一的网关接入微服务，在网关层处理所有的非业务功能个。通常，网关也是提供REST/HTTP的访问API。服务端通过API-GW注册和管理服务。上图：通过API-网关暴露微服务所有的业务接口通过API网关暴露，是所有客户端接口的唯一入口。微服务之间的通信也通过API网关。\采用网关方式有如下优势：目前，API网关方式应该是微服务架构中应用最广泛的设计模式。微服务也可以集成在异步的场景下，通过队列和订阅主题，实现消息的发布和订阅。一个微服务可以是消息的发布者，把消息通过异步的方式发送到队列或者订阅主题下。作为消费者的微服务可以从队列或者主题共获取消息。通过消息中间件把服务之间的直接调用解耦。上图：异步通信方式通常异步的生产者/消费者模式，通过AMQP, STOMP, MQTT 等异步消息通讯协议规范。数据的去中心化单体架构中，不同功能的服务模块都把数据存储在某个中心数据库中。每个微服务有自己私有的数据库，其它微服务不能直接访问。单体架构，用一个数据库存储所有数据微服务方式，多个服务之间的设计相互独立，数据也应该相互独立（比如，某个微服务的数据库结构定义方式改变，可能会中断其它服务）。因此，每个微服务都应该有自己的数据库。每个微服务有自己私有的数据库，其它微服务不能直接访问。每个微服务有自己私有的数据库，其它微服务不能直接访问。数据去中心话的核心要点：数据的去中心化，进一步降低了微服务之间的耦合度，不同服务可以采用不同的数据库技术（SQL、NoSQL等）。在复杂的业务场景下，如果包含多个微服务，通常在客户端或者中间层（网关）处理。微服务架构的优点：微服务架构的缺点：微服务的一些想法在实践上是好的，但当整体实现时也会呈现出其复杂性。关于微服务架构的取舍

 

 微服务之架构技术选型与设计 本文主要介绍了架构技术选型与设计-微服务选型，Spring cloud 实现采用的技术，希望对您的学习有所帮助。架构技术选型与设计-DUBBODubbo，是阿里巴巴服务化治理的核心框架，并被广泛应用于阿里巴巴集团的各成员站点(阿里巴巴现在使用架构为HSF)。 于2012-10-24最后版本2.5.3成为最后一版本，由当当接手维护，命名为dubbox；2017年突然继续dubbo进行维护，最后更新版本时间为 2017-10-11 22:21Dubbo 核心部件:Provider： 暴露服务的提供方。Consumer：调用远程服务的服务消费方。Registry： 服务注册中心和发现中心。Monitor： 统计服务和调用次数，调用时间监控中心。（dubbo的控制台页面中可以显示）Container：服务运行的容器。Dubbo服务集群-集群容错模式架构技术选型与设计-微服务选型架构技术选型与设计-DUBBO架构技术选型与设计-DUBBO架构技术选型与设计-微服务选型Spring Cloud，从命名我们就可以知道，它是Spring Source的产物，Spring社区的强大背书可以说是Java企业界最有影响力的组织了，除了Spring Source之外，还有Pivotal和Netfix是其强大的后盾与技术输出。其中Netflix开源的整套微服务架构套件是Spring Cloud的核心。如果拿Dubbo与Netflix套件做对比，前者在国内影响力较大，后者在国外影响力较大，在背景上可以打个平手；但是若要与Spring Cloud做对比，由于Spring Source的加入，在背书上，Spring Cloud略胜一筹，但是在高并发上dubbo曾经在阿里的运营中实际承载过过亿用户同时在线的，而Netflix 并没有实际的上线应用中体现过。Spring Cloud下面有19个子项目（可能还会新增）分别覆盖了微服务架构下的方方面面，服务治理只是其中的一个方面，一定程度来说，Dubbo只是Spring Cloud Netflix中的一个子集。但是在选择框架上，方案完整度恰恰是一个需要重点关注的内容，当然从高可用和高并发一起考虑，Spring Cloud 无疑是最佳选择。1、Spring Cloud Config 配置中心，利用git集中管理程序的配置。2、Spring Cloud Netflix 集成众多Netflix的开源软件3、Spring Cloud Bus 消息总线，利用分布式消息将服务和服务实例连接在一起，用于在一个集群中传播状态的变化4、Spring Cloud for Cloud Foundry 利用Pivotal Cloudfoundry集成你的应用程序5、Spring Cloud Cloud Foundry Service Broker 为建立管理云托管服务的服务代理提供了一个起点。6、Spring Cloud Cluster 基于Zookeeper, Redis, Hazelcast, Consul实现的领导选举和平民状态模式的抽象和实现。7、Spring Cloud Consul 基于Hashicorp Consul实现的服务发现和配置管理。8、Spring Cloud Security 在Zuul代理中为OAuth2 rest客户端和认证头转发提供负载均衡9、Spring Cloud Sleuth SpringCloud应用的分布式追踪系统，和Zipkin，HTrace，ELK兼容。10、Spring Cloud Data Flow 一个云本地程序和操作模型，组成数据微服务在一个结构化的平台上。11、Spring Cloud Stream 基于Redis,Rabbit,Kafka实现的消息微服务，简单声明模型用以在Spring Cloud应用中收发消息。12、Spring Cloud Stream App Starters 基于Spring Boot为外部系统提供spring的集成14、Spring Cloud Task App Starters15、Spring Cloud Zookeeper 服务发现和配置管理基于Apache Zookeeper。16、Spring Cloud for Amazon Web Services 快速和亚马逊网络服务集成。17、Spring Cloud Connectors 便于PaaS应用在各种平台上连接到后端像数据库和消息经纪服务。18、Spring Cloud Starters （项目已经终止并且在Angel.SR2后的版本和其他项目合并）19、Spring Cloud CLI 插件用Groovy快速的创建Spring Cloud组件应用。Spring Cloud共集成了19个子项目，里面都包含一个或者多个第三方的组件或者框架！1、spring cloud ： 一个云应用工具，为云应用开发的配置管理、服务发现、断路器、智能路由、微代理、控制总线、全局锁定、决策竞选、分布式会话和集群状态管理等操作2、spring cloud config ：配置管理开发工具包3、 spring cloud Bus ：事件消息总线用于集群（例如：配置变化时间）中传播状态变化，与spring cloud config 联合实现热部署4、 spring cloud Netflix Eureka ： 云端负载均衡基础，一个基于Rest的服务，用于定位服务，以实现云端的负载均衡和中间层服务器的故障转移5、 spring cloud Netflix Hystrix ： 容错管理工具，旨在通过控制服务和第三方库的节点，从而对延迟和故障提供更强大的容错能力6 、 Netflix ZUUL： 边缘服务工具，提供动态路由、监控、弹性、安全等边缘服务7、 spring cloud sleuth ：日志收集工具包、封装Purpose 、Zipkin和Trace8、 Spring Cloud Security ： 安全工具包，为应用程序添加安全控制，主要是OAuth29、 spring cloud turbine ：聚合服务器发送时间流，监控集群下Netflix 和 metrics 情况Spring cloud 配置中心Spring cloud 注册中心Spring cloud 网关: 服务路由、安全认证、会话共享、客户端负载均衡、统一异常处理、跨域请求Spring cloud 断路由

 大家了解微服务架构的核心吗 

 如何使用 java 构建微服务 spring cloud介绍 spring cloud是一个基于spring boot实现的云应用开发工具，它为基于jvm的云应用开发中的配置管理、服务发现、断路器、智能路由、微代理、控制总线、全局锁、决策竞癣分布式会话和集群状态管理等操作提供了一种简单的开发方式。

  